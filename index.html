<!DOCTYPE html>
<html lang = 'en'>
  <head>
    <meta charset = 'UTF-8'>
		<link rel = 'stylesheet' href = 'main.css'>
    <!-- <link href="https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.js"></script> -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://d3js.org/topojson.v2.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,500" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css">

		<style>
			.topnav {
				position: fixed;
				width: 100%;
				top:0px;
				padding-top: 20px;
				margin-left: 0px;
				margin-right: 0px;
				padding-left:0px;
				padding-bottom: 10px;
				padding-right: 200px;
			  overflow: hidden;
			  background-color: #7B909A;
				z-index:995;
				box-shadow: 0px 2px 15px rgba(0, 0, 0, 0.1);
			}

			.topnav :hover {
			  background-color: #7B909A;
				text-decoration: none;
				opacity: 1

			}

			.topnav a {

				display: block;
				position: fixed;
			  float: right;
			  color: #c1cfd6;
				margin-right: 10px;
				margin-left: 10px;

			  text-align: center;
			  padding: 15px 12px;
			  text-decoration: none;
			  font-size: 17px;

			}

			.topnav a:hover {
				background-color: #7B909A;
				text-decoration: none;
			  color: #e1ebf0;

			}

			.topnav a.active {
				background-color:#7B909A;
			  color: white;

			}

			.navholder{
				margin:5px;
				width: 100% ;
				height:50px;
			  border-radius: 4px;
			  background-color: #7B909A;
			}

			.tc{
				text-align: center;
				padding-bottom:40px;
				width: auto;
				height:100% auto;
				border-radius: 4px;
				background-color: #ffffff;
			}

      p {
        font-family: 'Nunito', sans-serif;
        font-size: 16px;
        color:#222222;
        font-weight:300;
        line-height: 1.5;
        text-align: justify;
        text-justify:inter-word;
      }
      h1 {
        font-family: 'Nunito', sans-serif;
        color:#222222;
        font-size:48px;
        opacity: 1;
        line-height:1.3;
        /*text-shadow: 10px 10px 10px #000;*/
      }

      h2 {
        font-family: 'Nunito', sans-serif;
        color:#242424;
        font-size:26px;
        font-weight:50;
        line-height:1.3;
        /*text-shadow: 5px 5px 5px #000;*/
      }

      a {
        font-family: 'Nunito', sans-serif;
        font-size: 16px;
        color:#222222;
        font-weight:300;
        text-justify:inter-word;

      }

      #tooltip.hidden {
          display: none;
        }

      #tooltip {
           position: absolute;
           width: 250px;
           height: 55px;
           padding: 5px;
           background-color: white;
           border: solid white 1px;
           z-index:10;
           opacity: 0.7;
           font-family: "Nunito, sans-serif";
         }
       /* Add CSS classes for p to make the font-size 12 px */


       .button1 {
       background-color: white;
       border: solid #fbb4ae 2.5px;
       color: black;
       padding: 12px 36px;
       text-align: center;
       text-decoration: none;
       display: inline-block;
       font-size: 16px;
     }
       .button2 {
       background-color: white;
       border:solid #b3cde3 2.5px;
       color: black;
       padding: 12px 36px;
       text-align: center;
       text-decoration: none;
       display: inline-block;
       font-size: 16px;
     }
       .button3 {
       background-color: white;
       border: solid #ccebc5 2.5px;
       color: black;
       padding: 12px 36px;
       text-align: center;
       text-decoration: none;
       display: inline-block;
       font-size: 16px;
     }
     .button4 {
     background-color: white;
     border: solid #decbe4 2.5px;
     color: black;
     padding: 12px 36px;
     text-align: center;
     text-decoration: none;
     display: inline-block;
     font-size: 16px;
    }
    .button5 {
    background-color: white;
    border: solid #fed9a6 2.5px;
    color: black;
    padding: 12px 36px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    }

    .button1:hover {
      background-color: #fbb4ae;
      border: solid white 2.5px;
      color: black;
      padding: 12px 36px;
    }
    .button2:hover {
      background-color: #b3cde3;
      border: solid white 2.5px;
      color: black;
      padding: 12px 36px;
    }
    .button3:hover {
      background-color: #ccebc5;
      border: solid white 2.5px;
      color: black;
      padding: 12px 36px;
    }
    .button4:hover {
      background-color: #decbe4;
      border: solid  white 2.5px;
      color: black;
      padding: 12px 36px;
    }
    .button5:hover {
      background-color: #fed9a6;
      border: solid white 2.5px;
      color: black;
      padding: 12px 36px;
    }

		</style>

  </head>

	<body>
		<div class="topnav">
			<div class = 'navholder'>
			</div>

			<a class="active" href="../document/index.HTML#Projects" style=" top:20px; left:1250px">Projects</a>
			<a href="../document/index.HTML" style=" top:20px; left:1150px">Home</a>
			<!-- <a class="active" href="#Home">Home</a> -->
			<a style="font-weight: lighter; color:white; font-size: 30px;  top:10px; left: 100px" href="../document/index.HTML"><span>Yanchao LI</span></a>

 		</div>

		<div id = 'Projects'>
  			<div class = 'placeholder'>
        </div>

  			<div >
  				<h3 style="text-align:center;"><span style="color:#333333; font-size:20px;">How could taxi trip records reveal urban dynamics?</span></h1>
  				<h3 style="text-align:center;font-weight: lighter;"><span style="color:#333333; font-size:18px;"><em>Relationship of Taxi Trips and Land Use Structure in New York City</em></span></h1>
          <!-- <h3 style="text-align:center;font-weight: lighter;"><span style="color:#706f6f; font-size:14px;"><em>Course Project; Collaborator: Ziyu Ran</em></span></h1> -->
  			</div>

  			<div style="margin-left:400px; margin-right:400px; margin-bottom: 50px">
  				<p ><span>Variety of datasets could provide perspectives for transportation planners to understand urban travel patterns. In this project, 7.4 million records of <a href="https://www1.nyc.gov/site/tlc/about/about-tlc.page"  target="_blank" rel="noopener">New York City taxi trips</a> – yellow and green taxi trips in 2019 June – were used to reveal urban dynamics in different urban regions, and to understand relationships between taxi inflows/ outflows and the land use structure. </span></p>
          <p ><span>Three questions are discussed below:</span></p>
          <p ><span>(1) How do the taxi inflows/ outflows vary in the morning and evening?</span></p>
          <p ><span>(2) How many types of the travel patterns can be identified?</span></p>
          <p ><span>(3) How do the travel patterns relate to land use structure?</span></p>

  			</div>

  			<!-- <div class = tc>
  				<img src="../image/taxi_0.jpg" alt="" width = 1000px; padding-bottom = 0px;>
          <p style="margin-left:400px; margin-right:400px; margin-bottom: 0px"><span> <a href = 'https://www.medicinenet.com/script/main/art.asp?articlekey=221357'target="_blank" rel="noopener">Image credit</a>  </span></p>
  			</div> -->



        <div style=" margin-left:400px; margin-right:400px; margin-bottom: 50px">
            <p ><span>One-month taxi trips were aggregated to each tract. The map below shows each tract's PICK-UP trips in the morning and evening. Swipe to compare the difference! </span></p>
            <p ><span><b> Map-A</b> &nbsp;&nbsp; Left: pick-up trips in the morning (7am:10am); &nbsp;&nbsp;Right: pick-up trips in the evening (5pm:8pm). Left and right maps have same scales. </span></p>
            <iframe src='../image/taxi_pick_ups.html' width='100%' height='400px' title='My file'></iframe>
        </div>

        <div style=" margin-left:400px; margin-right:400px; margin-bottom: 50px">
            <p ><span>The map below shows each tract's DROP-OFF trips in the morning and evening. Swipe to compare the difference! </span></p>
            <p ><span><b> Map-B</b> &nbsp;&nbsp; Left: drop-off trips in the morning(7am:10am); &nbsp;&nbsp;Right: drop-off trips in the evening(5pm:8pm). Map-A and Map-B have same scale. </span></p>
            <iframe src='../image/taxi_drop_offs.html' width='100%' height='400px' title='My file'></iframe>
        </div>

        <div style=" margin-left:400px; margin-right:400px; margin-bottom: 50px">
            <p ><span>Map-A & -B indicate some regions have very different urban dynamics in the morning and the evening. Besides, taxi inflows and outflows are unevenly distributed in urban regions. Actually, 90% of the taxi trips happened only in 35.7% of the urban tracts. The following analysis will focus on these taxi-frequently-visited urban tracts.  </span></p>
            <p ><span><i>  Normalized taxi inflows difference in the morning/ evening </i>  and <i> normalized taxi inflows difference in the morning/ evening</i>  are used to define taxi travel patterns. Five types of travel patterns are identified using K-means cluster algorithms. Map below shows the different types of the travel patterns and the land use structure in each type.
              </span></p>

        </div>

        <div style=" margin-left:400px; margin-right:400px; margin-bottom: 50px">
            <p ><span><b> Map-C</b> &nbsp;&nbsp; Taxi travel types in regions with 90% of the totl taxi trips in New York City </span></p>
            <img src='../image/taxi_types.png' width='500px' style = 'margin-left: 200px'></img>
        </div>

        <div style=" margin-left:400px; margin-right:400px; margin-bottom: 50px">
            <p ><span><b> Map-D</b> &nbsp;&nbsp; Left: regions of five different taxi travel patterns; &nbsp;&nbsp;Right: land use within the regions </span></p>
            <iframe src='../image/taxi_land_type.html' width='100%' height='400px' title='My file'></iframe>
        </div>

        <!-- Add a div element for tooltip -->
        <div id="tooltip" class="hidden">
          <p><span id="value">100</span></p>
        </div>


        <!-- Add buttons for each of the four neighborhoods -->
          <div style=" margin-left:400px; margin-right:400px; margin-bottom: 50px">
          <p ><span><b> Chart-A</b> &nbsp;&nbsp; Regions with different taxi travel patterns. Click the five types and see their land-use structures!</span></p>
          <input style=" margin-left:0px" type="button" class="button1" id="t1" value="Type 1" >
          <input style=" margin-left:80px" type="button" class="button2" id="t2" value="Type 2">
          <input style=" margin-left:80px" type="button" class="button3" id="t3" value="Type 3">
          <input style=" margin-left:80px" type="button" class="button4" id="t4" value="Type 4">
          <input style=" margin-left:80px" type="button" class="button5" id="t5" value="Type 5">
        </div>


      <div class="row">
        <div class="col-4">
            <div style=" margin-left:400px; margin-right:-180px;  margin-top: 250px;margin-bottom: 100px">
                <p style = 'line-height: 1.2;'><span>Type1: Tracts with more taxi pick-ups in the morning and more drop-offs in the evening. </span></p>
                <p style = 'line-height: 1.2;'><span>Type2: Tracts with more taxi pick-ups both in the morning and evening. </span></p>
                <p style = 'line-height: 1.2;'><span>Type3: Tracts with more taxi drop-offs both in the morning and evening. </span></p>
                <p style = 'line-height: 1.2;'><span>Type4: Tracts with more taxi drop-offs in the morning and more pick-ups in the evening. </span></p>
                <p style = 'line-height: 1.2;'><span>Type5: Tracts with an equilibrium taxi trips . </span></p>
            </div>
        </div>

        <div class="col-8">
          <div style=" margin-left:200px; margin-right:0px;  margin-top: 0px;margin-bottom: 100px">
            <div id="main">
            </div>
        </div>

      </div>

      <div style=" margin-left:400px; margin-right:400px; margin-top: -100px; margin-buttom: 450px">
          <p ><span><b> Conclusions</b></span></p>
          <p ><span>We can find that urban tracts with more heterogeneous land use types are likely to have an equilibrium taxi inflows and outflows, which means less empty-vehicle driving and less waste of energy. </span></p>
          <p><span>Urban tracts with homogenous land use structure such as commercial buildings/ residential buildings or transportation facilities, have a highly asymmetric taxi flow in the morning and evening peak hours. For instance, Midtown Manhattan, with over 80% percent of commercial and mixed buildings, has more than two times the number of taxi drop-offs than pick-ups in the morning.</span></p>
          <p><span>In addition, the proportion of transportation facilities – particularly airports (EWR, JFK, LGA) – has a significant influence on the regions’ taxi travel patterns. Interestingly, we can find JFK and LGA have more drop-off trips per day while EWR has more picked-ups. This can be partly explained by the yellow taxi and green taxi’s operation management policies</span></p>
          <p><span>Last but not least, the intermodal transportation – docks, subway stations and other public transportation facilities – are decisive to taxi trip patterns. A quantitative approach can be further explored by integrating other public transportation datasets.</span></p>
      </div>

      <div style=" margin-left:400px; margin-right:400px; margin-top: 50px; margin-buttom: 450px">
          <a ><span><b> Acknowledgement</b></span></a>
          <p style = 'margin-top: -1px'>Mapbox docs, swipe between maps, <a href="https://docs.mapbox.com/mapbox-gl-js/example/mapbox-gl-compare/"  target="_blank" rel="noopener">https://docs.mapbox.com/mapbox-gl-js/example/mapbox-gl-compare/</a></p>
          <p style = 'margin-top: -15px'>Using d3-tip to add tooltips to a d3 bar chart, <a href="http://bl.ocks.org/caged/6476579"  target="_blank" rel="noopener">https://docs.mapbox.com/mapbox-gl-js/example/mapbox-gl-compare/</a> </p>
          <a ><span><b> References</b></span></a>
          <p  style = 'margin-top: -1px'>Hu, Liang, et al. "Analyzing battery electric vehicle feasibility from taxi travel patterns: The case study of New York City, USA." Transportation Research Part C: Emerging Technologies 87 (2018): 91-104.</p>
          <p style = 'margin-top: -15px'>Alemi, Farzad, et al. "What influences travelers to use Uber? Exploring the factors affecting the adoption of on-demand ride services in California." Travel Behaviour and Society 13 (2018): 88-104.</p>
          <a ><span><b> Data</b></span></a>
          <p style = 'margin-top: -1px'>NYC Taxi and Limousine Commission (TLC) record data, June of 2019</p>
          <p style = 'margin-top: -15px'>The Primary Land Use Tax Lot Output (PLUTO™) data file, 2019</p>


      </div>

      <div class = 'placeholder'>
      </div>


		</div>


		<button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>

		<script>

      var t1 = [["Residential_Buildings", 35.98], ["Commercial_and_Mixed", 20.18], ["Industrial_and_Manufacturing", 8.09],["Transportation_and_Utility", 12.70], ["Public_Facilities_and_Institutions", 6.81], ["Open_Space_and_Outdoor_Recreation", 14.05], ["Vacant_Land", 2.20]]
      var t2 = [["Residential_Buildings", 19.59], ["Commercial_and_Mixed", 8.34],  ["Industrial_and_Manufacturing", 1.76],["Transportation_and_Utility", 50.99], ["Public_Facilities_and_Institutions", 4.14], ["Open_Space_and_Outdoor_Recreation", 13.64], ["Vacant_Land", 1.55]]
      var t3 = [["Residential_Buildings", 43.98], ["Commercial_and_Mixed", 13.09], ["Industrial_and_Manufacturing", 8.33],["Transportation_and_Utility", 18.24], ["Public_Facilities_and_Institutions", 6.82], ["Open_Space_and_Outdoor_Recreation", 6.51],  ["Vacant_Land", 3.03]]
      var t4 = [["Residential_Buildings", 26.72], ["Commercial_and_Mixed", 42.16],  ["Industrial_and_Manufacturing", 2.93],["Transportation_and_Utility", 9.16], ["Public_Facilities_and_Institutions", 9.05], ["Open_Space_and_Outdoor_Recreation", 6.83],  ["Vacant_Land", 3.15]]
      var t5 = [["Residential_Buildings", 25.57], ["Commercial_and_Mixed", 23.11],  ["Industrial_and_Manufacturing", 4.8],["Transportation_and_Utility", 13.65], ["Public_Facilities_and_Institutions", 13.43], ["Open_Space_and_Outdoor_Recreation", 14.29], ["Vacant_Land", 4.16]]



    	// Define height and width variables (height of 720, width of 1200)


      	var height = 780;
      	var width = 1300;
      	var barWidth = 40;
      	var h_spacing = 30;


      	// Add an SVG element

      	var svg = d3.select("div#main")
      				.append("svg")
         			.attr("width", width)
         			.attr("height", height);


      	// Bind data to rectangles to create the bar chart. Add mouseovers for the hovers.

      	// Initialize data and neighborhood name with roslindale
      	var data = t2;
      	var pattern_name = "t2";
        //var color_Column = ['Residential_Buildings','Commercial_and_Mixed','Industrial_and_Manufacturing','Transportation_and_Utility','Public_Facilities_and_Institutions','Open_Space_and_Outdoor_Recreation','Vacant_Land']
        var color = d3.scaleOrdinal(d3.schemeCategory10).range(['#f9e54e', '#b11616', '#bf9675', '#b7b4cf', '#7ebae2', '#3f8d44', '#f1efef']);
      	svg.selectAll("rect")
      		   	.data(data)
      		   	.enter()
      		   	.append("rect")

      		   	.attr("x", function(d, i) {return  20 + i*(barWidth+40) +h_spacing;
      									})
      		   	.attr( "y", d => 500-(d[1]*9))
      		   	.attr("width", barWidth)
      		   	.attr( "height", d => (d[1]*9)) // Set height of rectangle to data value
              .attr("fill", function (d){ return color(d[0]); })
      		   	.on("mouseover", function(d) {
      		   					 d3.select("#tooltip")
      		   					 .style("left", d3.event.pageX + "px")
      		   					 .style("top", d3.event.pageY + "px")
      		   					 .select("#value")
      		   					 .html("<a>" + d[0] +": "+ String(d[1]) +"% "+"</a>")
      		   			 d3.select("#tooltip").classed("hidden", false);
      		   			 })

      		   			 .on("mouseout", function() {
      		   				 d3.select("#tooltip").classed("hidden", true);
      		   			 });


        // Create y-axis
        // svg.append("line")
        // 	.attr("x1", 50)
        // 	.attr("y1", 50)
        // 	.attr("x2", 50)
        // 	.attr("y2", 500)
        // 	.attr("stroke-width", 1.5)
        // 	.attr("stroke", "grey")
        // 	.attr("opacity", .5);
        //
        // // Create x-axis
        // svg.append("line")
        // 	.attr("x1", 50)
        // 	.attr("y1", 500)
        // 	.attr("x2", 580)
        // 	.attr("y2", 500)
        // 	.attr("stroke-width", 1.5)
        // 	.attr("stroke", "grey")
        // 	.attr("opacity", .5);

          // Add a Label
          // y-axis label
          svg.append("text")
          .attr("font-family", "Nunito, sans-serif")
          .attr("font-size", "14px")
        	.attr("class", "y label")
        	.attr("text-anchor", "end")
        	.text("Land Use Proportions")
        	.attr("transform", "translate(40, 200),rotate(-90)");//

          //x-axis label
          svg.selectAll(".text")
          	 .data(data)
          	 .enter()
          	 .append("text")
             .attr("font-family","Nunito, sans-serif")
             .attr("font-size" ,"14px")
          	 .attr("y", function(d, i) {return 20 +  i*(barWidth+40) +h_spacing/2;
        							})
          	 .attr("x", -40)
          	 .attr("dy", ".75em")
          	 .attr("text-anchor", "end")
          	 .attr("class", "label")

          	 .text(function(d) {return d[0].replaceAll("_", " ");})
          	 .attr("transform", " translate(20, 470),rotate(-90)");

             function bar_plot(data){
             svg.selectAll("rect")
             .data(data)
             .transition().duration(1200)
             .attr( "height", function(d) {
               return d[1]*9;
               })
             .attr( "y", function(d) {
               return 500 - (d[1]*9)
               })
           }

           // Click to update data and neighborhood name and then execute plot to update viz:
          	d3.select("input#t1")
          		.on("click", function() {
          			data = t1
          			pattern_name = "t1"
          			bar_plot(data)
          			//map_plot(data)
          		})

              d3.select("input#t2")
          		.on("click", function() {
          			data = t2
          			pattern_name = "t2"
          			bar_plot(data)
          			//map_plot(data)
          		})

          	d3.select("input#t3")
          		.on("click", function() {
          			data = t3
          			pattern_name = "t3"
          			bar_plot(data)
          			//map_plot(data)
          		})

          	d3.select("input#t4")
          		.on("click", function() {
          			data = t4
          			pattern_name = "t4"
          			bar_plot(data)
          			//map_plot(data)
          		})

           d3.select("input#t5")
          		.on("click", function() {
          			data = t5
          			pattern_name = "t5"
          			bar_plot(data)
          			//map_plot(data)
          		})

    			var mybutton = document.getElementById("myBtn");

    			window.onscroll = function() {scrollFunction()};

    			function scrollFunction() {
    				if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    					mybutton.style.display = "block";
    				} else {
    					mybutton.style.display = "none";
    				}
    			}

    			function topFunction() {
    				document.body.scrollTop = 0;
    				document.documentElement.scrollTop = 0;
    			}




		</script>

		<div id = 'footer'>
			<hr>
			<p>@Yanchao Li 2020</p>
		</div>
 	</body>
</html>
